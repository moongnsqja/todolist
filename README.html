const body = document.querySelector("body");

const IMG_NUMBER = 3;

function handleImgLoad(params) {
    console.log("finished loading");
}

function paintImage(imgNumber) {
    const image = new Image();
    image.src = `image/${imgNumber+1}.jpg`;
    image.classList.add("bgImage");
    body.appendChild(image);
    image.addEventListener("loadend", handleImgLoad);
}

function genRandom(params) {
    const number = Math.floor(Math.random()*IMG_NUMBER);
    return number;
}
//math.ceil(ìˆ«ì) ì˜¬ë¦¼, math.floor(ìˆ«ì) ë‚´ë¦¼

function init(params) {
    const randomnumber = genRandom();
    paintImage(randomnumber);
}
init(); 

const form = document.querySelector(".js-form"),
    input = form.querySelector("input"),
    greeting = document.querySelector(".js-greetings");

const USER_LS="currentUser",
    SHOWING_CN = "showing";

function saveName(text) {
    localStorage.setItem(USER_LS, text);
}

function handleSubmit(event) {
    event.preventDefault(); //ì´ˆê¸°í™” ë˜ëŠ”ê±¸ ë§‰ì•„ì£¼ê³ 
    const currentValue = input.value; //usernameì„ ë°›ê³ 
    console.log(currentValue);
    paintGreeting(currentValue);//ë°‘ì— í‘ì…˜ì„ í•´ì¤€ë‹¤
    saveName(currentValue);
}

function askForName(params) {
    form.classList.add(SHOWING_CN);
    form.addEventListener("submit", handleSubmit);
}

function paintGreeting(text) {//()ì•ˆì— ìˆëŠ”ê±´ argument ì¸ìˆ˜
    form.classList.remove(SHOWING_CN);//textë¥¼ ìƒ‰ì¹ í•˜ë ¤ë©´ formì„ ìˆ¨ê²¨ì•¼í•¨
    greeting.classList.add(SHOWING_CN);
    greeting.innerText = `HelloğŸ˜‹ ${text}`;
}

function loadName(params) {
    const currentUser = localStorage.getItem(USER_LS);
    if(currentUser === null){
        askForName();
    }else{//userê°€ ìˆì„ ë•Œ
        paintGreeting(currentUser);
    }
}
function init(params) {
    loadName();
}
init();

const clockContainer = document.querySelector(".js-clock"),
 clockTitle = clockContainer.querySelector("h1");


 function getTime(params) {
     const date = new Date(); //DateëŠ” class full stack jsì—ì„œ í™•ì¸ ê°€ëŠ¥
     const minutes = date.getMinutes();
     const hours = date.getHours();
     const seconds = date.getSeconds();
     clockTitle.innerText = `${hours <10 ? `0${hours}`:hours}:${minutes < 10 ? `0${minutes}` :minutes}:${seconds < 10 ? `0${seconds}`:seconds}`;
     //ternary operator (ì‚¼í•­ì—°ì‚°ì or ë¯¸ë‹ˆif
     //?ëŠ” ì§ˆë¬¸ì´ê³  :ëŠ” else
 }

function init(params){
 getTime();  
 setInterval(getTime, 1000);
 //setInterval(a,b) a= í•¨ìˆ˜ì´ê³  bëŠ” ì‹¤í–‰í•  ì‹œê°„ ê°„ê²©(ì‹œê°„ë‹¨ìœ„ëŠ” ë°€ë¦¬ì„¸ì»¨)
}
init(); 

.form,
.gettings{
    display: none;
}/*h1, h4 íƒœê·¸ ì•ˆì— class ë’¤ì— ìˆëŠ” ê²ƒì— ì ìš©í•˜ëŠ” ê²ƒì„*/
.showing{
    display: block;
}

@keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

.bgImage{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    animation: fadeIn 0.5s linear;
}
body{
    color: white;
}
.js-clock{
  position: absolute;
  top: 100px;
  left: 550px;
  font-size: 50px;
}
.js-weather{
  position: absolute;
  right: 2%;
  top: 10px;
  font-size: large;
  font-weight: bold;
}
.position{
  position: absolute;
  left: 44%;
  top: 300px;
}
.js-toDoList{
  font-size: 20px; 
}
.js-greetings{
  color: brown;
  font-size: 30px;
} 

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="momentum.css">
</head>
<body>
    <div class="js-clock">
        <h1 class="js-title"></h1>
    </div>
    <div class="position">
    <!--ìœ„ì¹˜ ë°”ê¾¸ëŠ”ê±° ì•Œì•„ë³´ê¸°-->
        <form class="js-form form">
            <input type="text" placeholder="what is your name?">
        </form>
        <h1 class="js-greetings greetings"></h1>

        <form class="js-toDoForm">
            <input type="text" placeholder="white a to do">
            <!--placeholderëŠ” í…ìŠ¤íŠ¸ ì°½ì— ì•ˆë‚´ë¬¸ê°™ì€ê±°-->
        </form>
        <ul class="js-toDoList">
        </ul>
    </div>
    <span class="js-weather"></span>

    <script src="momentum-clock.js"></script>
    <script src="greeting.js"></script>
    <script src="todo.js"></script>
    <script src="bg.js"></script>
    <script src="weather.js"></script>
</body>
</html>

/*
const toDoForm = document.querySelector(".js-toDoForm"),
    toDoInput = toDoForm.querySelector("input"),
    toDoList = document.querySelector(".js-toDoList");
const TODOS_LS = 'toDos';
const toDos = [];
function saveToDos(params) {
    localStorage.setItem(TODOS_LS, JSON.stringify(toDos));
    /*JSON.stringifyëŠ” ë°ì´í„°ë¥¼ ì „ë‹¬í•  ë•Œ, ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ê·¸ê±¸ ë‹¤ë£° ìˆ˜ ìˆê²Œ ë³€í˜•ì‹œì¼œì£¼ëŠ” ê²ƒ 
    ìë°”ìŠ¤í¬ë¦½íŠ¸object -> string or string -> object
    ì“´ ì´ìœ ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ stringìœ¼ë¡œ ì €ì¥í•˜ë ¤ê³  í•˜ëŠ”ë° 
    ì—¬ê¸°ì„œ ì €ì¥ë  ë•Œ objectë¡œë¨ ê·¸ë˜ì„œ stringìœ¼ë¡œ ë°”ê¾¸ë ¤ê³  ì”€
}
function paintToDo(text) {
    const li = document.createElement("li");    //make entpy li
    const delBtn = document.createElement("button");     //make span button
    const span = document.createElement("span");
    const newId = toDos.length +1;
    delBtn.innerText = "âŒ";
    span.innerText = text;  //this text comes from submit function
    li.appendChild(span);   // span put in li
    li.appendChild(delBtn); // button inside of the li
    li.id = newId;
    toDoList.appendChild(li);
    const toDoObj = {
        text: text,
        id: newId
        
    };
    toDos.push(toDoObj);
    saveToDos();
}//local storageì—ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ dataë¥¼ ì €ì¥í•  ìˆ˜ ì—†ê³  stringë§Œ ì €ì¥ ê°€ëŠ¥
function handleSubmit(event) {
    event.preventDefalut();
    const currentValue = toDoInput.value;
    paintToDo(currentValue);
    toDoInput.value = ""; //ê°’ì„ ì…ë ¥ í•œ í›„ì— inputì°½ì„ ë¹„ìš´ë‹¤ ì´ê±° ì•ˆí•˜ë©´ ê·¸ëŒ€ë¡œ ë‚¨ì•„ ì‡ìŒ
}
function loadToDos(params) {
    const loadedToDos = localStorage.getItem(TODOS_LS);
    if(loadToDos !== null){
      const parsedToDos = JSON.parse(loadedToDos);
      parsedToDos.forEach(function(toDo){
        paintToDo(toDo.text);
      }); 
      //arrayì— ë‹´ê²¨ìˆëŠ” ê²ƒë“¤ì„ ê°ê°ì— í•œë²ˆì”© í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œì¼œì¤€ë‹¤
      // toDos==null ì¼ ë•Œ toDoFormì€ í•­ìƒ ë³´ì´ê¸° ë•Œë¬¸ì— í• ê²Œ ì—†ë‹¤
      //ê·¸ë˜ì„œ ê°™ì§€ ì•Šì„ ë•Œë¡œ í•œë‹¤
    }
}
    function init(params) {
        loadToDos();
        toDoForm.addEventListener("submit", handleSubmit);
    }
    init();*/


   const toDoForm = document.querySelector(".js-toDoForm"),
   toDoInput = toDoForm.querySelector("input"),
   toDoList = document.querySelector(".js-toDoList");

 const TODOS_LS = "toDos";

 let toDos = [];



 function deleteToDo(event) {
   const btn = event.target;
   const li = btn.parentNode;
   toDoList.removeChild(li);
   const cleanToDos = toDos.filter(function (toDo) {
     return toDo.id !== parseInt(li.id);//li.idê°€ stringì´ì–´ì„œ parseIntë¥¼ ì´ìš©í•˜ì—¬ ìˆ«ìë¡œ ë°”ê¾¸ì–´ì¤Œ
   });
   toDos = cleanToDos;
   saveToDos();
 }


 function saveToDos() {
   localStorage.setItem(TODOS_LS, JSON.stringify(toDos));
 }

 function paintToDo(text) {
   const li = document.createElement("li");
   const span = document.createElement("span");
   const delBtn = document.createElement("button");
   const newId = toDos.length + 1;
   span.innerText = text;
   delBtn.innerText = "âŒ";
   delBtn.addEventListener("click",deleteToDo);
   li.appendChild(span);
   li.appendChild(delBtn);
   li.id = newId; //ì‚­ì œë¥¼ ìœ„í•œ idì„¤ì •  
   toDoList.appendChild(li);
   const toDoObj = {
     text: text,
     id: newId 
   };
   toDos.push(toDoObj); //element í•˜ë‚˜ë¥¼ ë„£ìŒ
   saveToDos();
 }

 function handleSubmit(event) {
   event.preventDefault();
   const currentValue = toDoInput.value;
   paintToDo(currentValue);
   toDoInput.value = "";
 }

 function loadToDos() {
   const loadedToDos = localStorage.getItem(TODOS_LS);
   if (loadedToDos !== null) {
     const parsedToDos = JSON.parse(loadedToDos);
     parsedToDos.forEach(function(toDo) {
       paintToDo(toDo.text);
     });
   }
 }

 function init() {
   loadToDos();
   toDoForm.addEventListener("submit", handleSubmit);
 }
 init();
 
//api = application Programming Interface
//ë‹¤ë¥¸ ì„œë²„ë¡œë¶€í„° ì†ì‰½ê²Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨
const weather = document.querySelector(".js-weather");

const API_KEY = `e8b927b829b8754318cd8e89a6db8493`;
const COORDS = `coords`;


function getWeather(lat, lng) {
    fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lng}&appid=${API_KEY}&units=metric`)
    //ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ì‚¬ìš©í•¨
    //fetch(`https://~~~~~~~`);
    .then(function (response) {
        return response.json();
        //jaì—ì„œ ë¬´ì–¸ê°€ê°€ ëë‚˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë°©ë²•ì€ .thenì‚¬ìš©í•˜ëŠ” ê²ƒ
    })
    .then(function name(json) {
        const temperature = json.main.temp;
        const place = json.name;
        weather.innerText  = `${temperature}â„ƒ @ ${place}`;
    });
} 

function saveCoords(coordsObj) {
    localStorage.setItem(COORDS, JSON.stringify(coordsObj));
}

function handleGeoSucces(position) {
    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;
    const coordsObj = {
        latitude,
        longitude
    };
    saveCoords(coordsObj);
    getWeather(latitude, longitude);
}

function handleGeoError (params) {
    console.log("cant access geo location");
}

function askForCoords(params) {
    navigator.geolocation.getCurrentPosition(handleGeoSucces, handleGeoError)
}//ë‚´ ìœ„ì¹˜ ì½ëŠ”ê±°

function loadCoords(params) {
    const loadedCoords = localStorage.getItem(COORDS);
    if(loadedCoords == null){
        askForCoords();
    } else{
        const parsedCoords = JSON.parse(loadedCoords); 
        getWeather(parsedCoords.latitude, parsedCoords.longitude);
    }
}

function init(params) {
    loadCoords();
}
init(); 
